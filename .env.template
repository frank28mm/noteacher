# OpenAI (可选主模型)
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
MODEL_REASONING=gpt-4o
MODEL_VISION=gpt-4o

# SiliconFlow - Qwen3-VL (视觉)
SILICON_API_KEY=
SILICON_BASE_URL=https://api.siliconflow.cn/v1
SILICON_VISION_MODEL=Qwen/Qwen3-VL-32B-Thinking
SILICON_REASONING_MODEL=Qwen/Qwen2.5-72B-Instruct

# 火山方舟 - Doubao 视觉
ARK_API_KEY=
ARK_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
ARK_VISION_MODEL=doubao-seed-1-6-vision-250815
# 火山方舟 - Doubao 推理（grade/chat）
ARK_REASONING_MODEL=doubao-seed-1-6-vision-250815

# Supabase (Storage + Database)
SUPABASE_URL=https://uitcnddxrnyfflhwmket.supabase.co
SUPABASE_KEY=
SUPABASE_BUCKET=homework-test-staging
DEV_USER_ID=dev_user
AUTH_REQUIRED=0

# OCR / QIndex (bbox/切片)
# - 默认推荐：siliconflow_qwen3_vl（Qwen3-VL 输出题号+bbox，能生成切片）
# - 兼容：siliconflow_deepseek（DeepSeek-OCR 主要输出纯文本；bbox 不稳定，可能生成 0 切片）
OCR_PROVIDER=siliconflow_deepseek

# QIndex 定位模型（bbox-only，SiliconFlow Chat Completions）
# QIndex Locator (Ark)
# - 题目定位 bbox（推荐用 Doubao-Vision）
ARK_QINDEX_MODEL=doubao-seed-1-6-vision-250815
ARK_QINDEX_TIMEOUT_SECONDS=180

# QIndex Locator (SiliconFlow) - optional
# 注意：Doubao 模型属于 Ark，请用 ARK_QINDEX_MODEL；不要把 doubao-* 填到 SILICON_QINDEX_MODEL
SILICON_QINDEX_MODEL=Qwen/Qwen3-VL-32B-Thinking
SILICON_QINDEX_TIMEOUT_SECONDS=180
SILICON_QINDEX_MAX_TOKENS=900

# DeepSeek OCR（文本OCR，可选）
SILICON_OCR_MODEL=deepseek-ai/DeepSeek-OCR
SILICON_OCR_TIMEOUT_SECONDS=60
SILICON_OCR_MAX_TOKENS=4096

# Baidu PaddleOCR-VL (OCR + 版面分析)
# 已暂停（额度太少），保留配置仅用于未来切回：
BAIDU_OCR_API_KEY=
BAIDU_OCR_SECRET_KEY=
BAIDU_OCR_OAUTH_URL=https://aip.baidubce.com/oauth/2.0/token
BAIDU_OCR_SUBMIT_URL=https://aip.baidubce.com/rest/2.0/brain/online/v2/paddle-vl-parser/task
BAIDU_OCR_QUERY_URL=https://aip.baidubce.com/rest/2.0/brain/online/v2/paddle-vl-parser/task/query
BAIDU_OCR_TIMEOUT_SECONDS=60
# 文档建议提交后 5～10 秒轮询；过快可能触发 QPS 限制
BAIDU_OCR_POLL_INTERVAL_SECONDS=5
BAIDU_OCR_POLL_MAX_SECONDS=60

# SLA / Time budgets（秒）
GRADE_COMPLETION_SLA_SECONDS=600
GRADE_VISION_TIMEOUT_SECONDS=240
GRADE_LLM_TIMEOUT_SECONDS=300
VISION_CLIENT_TIMEOUT_SECONDS=240
LLM_CLIENT_TIMEOUT_SECONDS=300
MAX_CONCURRENT_VISION=2
MAX_CONCURRENT_LLM=4

# Unified Vision-Grade Agent
ENABLE_UNIFIED_VISION_GRADE=0
UNIFIED_AGENT_FALLBACK_TO_LEGACY=0
UNIFIED_AGENT_MAX_CONCURRENCY=2
UNIFIED_AGENT_TIMEOUT_SECONDS=600
UNIFIED_AGENT_MAX_TOKENS=1600
JSON_REPAIR_MAX_ATTEMPTS=1
JUDGMENT_BASIS_MIN_LENGTH=2
OPENCV_PROCESSING_TIMEOUT=30
OPENCV_PROCESSING_MAX_BYTES=20971520

# Demo UI 客户端超时（必须 >= GRADE_COMPLETION_SLA_SECONDS，否则 UI 可能先超时显示“系统错误”但后端仍在运行）
DEMO_GRADE_TIMEOUT_SECONDS=660
DEMO_AUTH_TOKEN=

# BBox + Slice（切片生成）
SLICE_PADDING_RATIO=0.05
SLICE_TTL_SECONDS=604800

# 产品保留策略（后续落库/定时清理任务会使用）
CHAT_HISTORY_TTL_DAYS=7
SUBMISSION_INACTIVITY_PURGE_DAYS=180

# QIndex worker queue（需要 Redis）
QINDEX_QUEUE_NAME=qindex:queue

# Redis（cache + queue；API 与 worker 必须同源）
REDIS_URL=redis://127.0.0.1:6379/0
CACHE_PREFIX=

# 通用
LOG_LEVEL=INFO
LOG_TO_FILE=1
LOG_FILE_PATH=logs/backend.log
